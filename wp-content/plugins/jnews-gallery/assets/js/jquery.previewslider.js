!function(e){"use strict";var i=function(i,t){this.element=e(i),this.options=t,this.holder=e(".jeg_preview_media_content_holder",i),this.slider=e(".jeg_preview_bottom_slider",i),this.nav_next=e(".jeg_preview_media_content_navigation > div.next",i),this.nav_prev=e(".jeg_preview_media_content_navigation > div.prev",i),this.control_index=e(".jeg_preview_control .counter .current",i),this.thumb=e(".jeg_preview_bottom_slider > a",i),this.subtitle=e(".jeg_preview_control .subtitle",i),this.description=e(".jeg_hidden_preview_description",i),this.description_wrap=e(".jeg_preview_description_wrapper",i),this.slider_ads=e(".jeg_preview_slider_ads",i),this.mode="normal",this.mode_switcher=e(".fullscreen-switch",i),this.preview_holder=e(".jeg_preview_holder",i),this.description_holder=e(".jeg_preview_description",i),this.preview_content=e(".jeg_preview_media_content",i),this.text_title=e(".jeg_preview_media_holder h3",i),this.index=0,this.max=this.thumb.length-1,this.zoom_size=0,this.zoom_reduce=e(".jeg_preview_control .reduce",i),this.zoom_increase=e(".jeg_preview_control .increase",i),this.zoom_cache=null,this.zoom_lock=!0,this.zoom_limit=[0,0,0,0],this.init()};i.DEFAULTS={rtl:!1,native_zoom:!0,slideSpeed:100,fit:"fit",zoom_max:5,zoom_step:20,fullscreen_stop:976},i.prototype.init=function(){this.bind_event(),this.create_slider_normal(),this.assign_slider_event(),this.first_load()},i.prototype.first_load=function(){this.change_content(),this.change_subtitle(),this.slider_navigation_check()},i.prototype.bind_event=function(){var i,t=this;t.zoom_reduce.on("click",(function(){t.change_zoom("reduce")})),t.zoom_increase.on("click",(function(){t.change_zoom("increase")})),t.holder.on("dblclick",(function(){t.mode_switcher.trigger("click")})),t.thumb.on("click",(function(i){i.preventDefault(),t.index=e(this).data("id"),t.do_change_slider()})),t.holder.on("mousedown",(function(i){e(this).addClass("draggable");var o=i.pageY,s=i.pageX;e(window).on("mousemove",(function(e){t.do_dragging(e.pageX-s,e.pageY-o),o=e.pageY,s=e.pageX})).on("mouseup",(function(){e(this).removeClass("draggable"),e(window).unbind("mousemove")})),i.preventDefault()})).on("mouseup",(function(){e(this).removeClass("draggable"),e(window).unbind("mousemove")})),t.mode_switcher.on("click",e.proxy((function(e){t.options.native_zoom?t.switch_mode():null===jnewsoption?t.open_magnific_popup():"photoswipe"===jnewsoption.popup_script?t.open_photoswipe_popup():t.open_magnific_popup(),e.preventDefault()}),t)),e(window).bind("resize",(function(){clearTimeout(i),i=setTimeout((function(){"normal"===t.mode?t.resize_normal():"fullscreen"===t.mode&&t.resize_fullscreen()}),50)}))},i.prototype.open_magnific_popup=function(){var i=this,t=i.options.image_sequence,o=i.index;e.magnificPopup.instance.next=function(){e.magnificPopup.proto.next.call(this),i.index>=i.max?i.index=0:i.index=i.index+1,i.do_change_slider()},e.magnificPopup.instance.prev=function(){e.magnificPopup.proto.prev.call(this),0===i.index?i.index=i.max:i.index=i.index-1,i.do_change_slider()},e.magnificPopup.open({items:t,gallery:{enabled:!0},type:"image",closeOnContentClick:!0,closeBtnInside:!1,fixedContentPos:!0,mainClass:"mfp-no-margins mfp-with-zoom",image:{verticalFit:!0}},o)},i.prototype.open_photoswipe_popup=function(){var i=this,t=i.options.image_sequence,o=i.index,s=e(".pswp").get(0),n=new PhotoSwipe(s,PhotoSwipeUI_Default,t,{index:o,history:!1,focus:!1,showAnimationDuration:0,hideAnimationDuration:0});n.listen("afterChange",(function(){i.index=n.getCurrentIndex(),i.do_change_slider()})),n.init()},i.prototype.switch_mode=function(){"normal"===this.mode?this.fullscreen_mode():"fullscreen"===this.mode&&this.normal_mode()},i.prototype.fullscreen_mode=function(){this.mode="fullscreen",e("body").addClass("jeg_preview_body_hidden"),this.go_fullscreen(!0),this.keyboard_event("bind")},i.prototype.normal_mode=function(){this.mode="normal",e("body").removeClass("jeg_preview_body_hidden"),this.go_normal(),this.keyboard_event("unbind")},i.prototype.keyboard_event=function(i){var t=this;"bind"===i?e("body").on("keydown",(function(e){37==e.keyCode?t.change_slider("prev"):39==e.keyCode?t.change_slider("next"):27==e.keyCode&&(t.mode="normal",t.normal_mode()),e.preventDefault()})):"unbind"===i&&e("body").unbind("keydown")},i.prototype.resize_normal=function(){this.change_content()},i.prototype.resize_fullscreen=function(){e(window).width()>this.options.fullscreen_stop?this.go_fullscreen(!1):(this.mode="normal",this.normal_mode())},i.prototype.go_fullscreen=function(i){var t,o=e(window).width(),s=e(window).height();t=o-400,this.element.addClass("fullscreen"),this.preview_holder.outerWidth(t),this.description_holder.outerWidth(400),this.description_wrap.outerHeight(s-this.slider_ads.outerHeight()),i&&(this.recreate_slider(),this.create_slider_fullscreen()),this.preview_content.outerHeight(s-this.slider.outerHeight()-this.text_title.outerHeight()),this.change_content()},i.prototype.go_normal=function(){this.element.removeClass("fullscreen"),this.preview_holder.css("width","auto"),this.description_holder.css("width","auto"),this.preview_content.css("height","auto"),this.recreate_slider(),this.create_slider_normal(),this.change_content()},i.prototype.recreate_slider=function(){this.slider.trigger("destroy.owl.carousel").removeClass("owl-loaded"),this.slider.find(".owl-stage-outer").children().unwrap()},i.prototype.create_slider_normal=function(){this.slider.owlCarousel({rtl:this.options.rtl,lazyLoad:!0,nav:!1,margin:15,navText:["",""],dots:!1,stagePadding:15,responsive:{0:{items:3},480:{items:4},768:{items:5},1e3:{items:7}}})},i.prototype.create_slider_fullscreen=function(){this.slider.owlCarousel({rtl:this.options.rtl,lazyLoad:!0,nav:!1,margin:15,navText:["",""],dots:!1,stagePadding:15,responsive:{0:{items:2},480:{items:3},768:{items:5},1e3:{items:6},1200:{items:8},1600:{items:10}}})},i.prototype.assign_slider_event=function(){var e=this;e.nav_next.on("click",(function(i){i.preventDefault(),e.change_slider("next")})),e.nav_prev.on("click",(function(i){i.preventDefault(),e.change_slider("prev")}))},i.prototype.change_slider=function(e){if(this.index="next"===e?this.index+1:this.index-1,this.index<0||this.index>this.max)return this.index<0&&(this.index=0),void(this.index>this.max&&(this.index=this.max));this.do_change_slider()},i.prototype.slider_navigation_check=function(){0===this.max?(this.nav_next.hide(),this.nav_prev.hide()):0===this.index?(this.nav_prev.hide(),this.nav_next.show()):this.index===this.max?(this.nav_next.hide(),this.nav_prev.show()):(this.nav_prev.show(),this.nav_next.show())},i.prototype.do_change_slider=function(){var i=e(this.thumb.get(this.index));i.parent(".owl-item").hasClass("active")||this.slider.trigger("to.owl.carousel",[this.index,this.options.slideSpeed,!0]),e(this.thumb).removeClass("active"),i.addClass("active"),this.control_index.text(this.index+1),this.change_content(),this.slider_navigation_check()},i.prototype.reset_zoom=function(){this.zoom_size=0,this.zoom_lock=!0,e(this.zoom_reduce).addClass("off"),e(this.zoom_increase).removeClass("off"),this.holder.removeClass("jeg_preview_grabbing")},i.prototype.change_subtitle=function(){var i=e(this.thumb.get(this.index)),t=e(i).data("title");return""===t?this.subtitle.hide():this.subtitle.show(),this.subtitle.text(t),t},i.prototype.change_description=function(){this.description.removeClass("active"),e(this.description.get(this.index)).addClass("active")},i.prototype.change_content=function(){var i=this,t=new Image,o=i.index,s=e(i.thumb.get(o)).data("image");i.reset_zoom(),i.holder.find("img").fadeOut((function(){e(this).remove()})),i.change_subtitle(),i.change_description(),e(t).load((function(){if(o===i.index){var s=i.image_resize_calc(t,i.holder,"fit");i.zoom_cache=s,e(t).addClass("jeg_preview_hide"),i.holder.append(t),e(t).css({height:Math.floor(s[0]),width:Math.floor(s[1]),left:Math.floor(s[2])+"px",top:Math.floor(s[3])+"px","max-width":"inherit"}).fadeIn(),i.zoom_lock=!1}})).attr("src",s)},i.prototype.change_zoom=function(i){if(!this.zoom_lock){if(this.zoom_size="increase"===i?this.zoom_size+1:this.zoom_size-1,this.zoom_size<0||this.zoom_size>this.options.zoom_max)return this.zoom_size<0&&(this.zoom_size=0),void(this.zoom_size>this.options.zoom_max&&(this.zoom_size=this.options.zoom_max));this.zoom_size<=0?(e(this.zoom_reduce).addClass("off"),e(this.zoom_increase).removeClass("off"),this.holder.removeClass("jeg_preview_grabbing"),this.zoom_size=0):this.zoom_size>=this.options.zoom_max?(e(this.zoom_reduce).removeClass("off"),e(this.zoom_increase).addClass("off"),this.holder.addClass("jeg_preview_grabbing"),this.zoom_size=this.options.zoom_max):(e(this.zoom_reduce).removeClass("off"),e(this.zoom_increase).removeClass("off"),this.holder.addClass("jeg_preview_grabbing")),this.change_image_zoom(i)}},i.prototype.do_dragging=function(e,i){if(this.zoom_size>0){var t=this.holder.find("img"),o=t.position(),s=o.top+i,n=o.left+e;s<this.zoom_limit[1]&&(s=this.zoom_limit[1]),s>this.zoom_limit[0]&&(s=this.zoom_limit[0]),n<this.zoom_limit[3]&&(n=this.zoom_limit[3]),n>this.zoom_limit[2]&&(n=this.zoom_limit[2]),t.css({top:s,left:n})}},i.prototype.change_image_zoom=function(i){var t,o,s,n,r,h,a=e(this.holder).find("img"),d=this.zoom_size,_=this.options.zoom_step,l=Math.floor(this.zoom_cache[0]+this.zoom_cache[0]*_*d/100),c=Math.floor(this.zoom_cache[1]+this.zoom_cache[1]*_*d/100);"increase"===i?(t=a.position().top-this.zoom_cache[0]*_/2/100,o=a.position().left-this.zoom_cache[1]*_/2/100):(t=a.position().top+this.zoom_cache[0]*_/2/100,o=a.position().left+this.zoom_cache[1]*_/2/100);var p=this.holder.height(),m=this.holder.width();p>l?n=(s=(p-l)/2)+l:(s=0,n=p-l),m>c?h=(r=(m-c)/2)+c:(r=0,h=m-c),this.zoom_limit=[s,n,r,h],this.zoom_size>0?(t<n&&(t=n),t>s&&(t=s),o<h&&(o=h),o>r&&(o=r)):(t=(p-l)/2,o=(m-c)/2),e(a).css({height:l,width:c,left:o+"px",top:t+"px"})},i.prototype.image_resize_calc=function(i,t){var o,s,n=e(i).get(0).naturalHeight,r=e(i).get(0).naturalWidth;0===n&&(n=e(i).data("height"),r=e(i).data("width"));var h=e(t).height(),a=e(t).width(),d=n/r;return h>n&&a>r?[o=n,s=r,(a-s)/2,(h-o)/2]:h/a>d?[o=a*d,s=a,(a-s)/2,(h-o)/2]:[o=h,s=h/d,(a-s)/2,(h-o)/2]};var t=e.fn.jpreviewslider;e.fn.jpreviewslider=function(t){return e(this).each((function(){var o=e(this),s=e.extend({},i.DEFAULTS,o.data(),"object"==typeof t&&t),n=o.data("jeg.previewslider");n||o.data("jeg.previewslider",n=new i(this,s))}))},e.fn.jpreviewslider.Constructor=i,e.fn.jpreviewslider.noConflict=function(){return e.fn.jpreviewslider=t,this}}(jQuery);